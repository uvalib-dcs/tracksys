<mets:mets xmlns:mets="http://www.loc.gov/METS/" xmlns:xlink="http://www.w3.org/1999/xlink"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="mets http://www.loc.gov/standards/mets/mets.xsd">
   <mets:dmdSec ID="collection-description-mods">
      <mets:mdRef LOCTYPE="PURL" MDTYPE="MODS" xlink:href="<%= Settings.tracksys_url %>/api/metadata/<%= metadata.pid %>?type=desc_metadata"/>
   </mets:dmdSec>
   <% metadata.children.each do |b| %>
   <mets:dmdSec ID="<%= b.pid.gsub(/:/,'_') %>-mods">
      <mets:mdRef LOCTYPE="PURL" MDTYPE="MODS" xlink:href="<%= mods_url(b.pid) %>" />
   </mets:dmdSec>
   <% end %>

   <mets:fileSec>
   <% metadata.children.each do |b| %>
      <mets:fileGrp USE="preview" ID="<%= b.pid.gsub(/:/,'_') %>-files">
         <mets:file ID="<%= b.pid.gsub(/:/,'_') %>-preview" DMDID="<%= b.pid.gsub(/:/,'_') %>-mods">
            <mets:FLocat LOCTYPE="PURL" xlink:href="<%= Settings.iiif_url %>/<%= b.pid %>/full/!125,125/0/default.jpg"/>
         </mets:file>
      </mets:fileGrp>
   <% end %>
   </mets:fileSec>

   <mets:structMap>
      <mets:div LABEL="Collection">
         <% metadata.children.each do |b| %>
         <mets:fptr FILEID="<%= b.pid.gsub(/:/,'_') %>-preview" />
         <% end %>
      </mets:div>
   </mets:structMap>
</mets:mets>
