if apollo_info.nil?
   attributes_table_for external_metadata do
      row :title
      row("External System") do |am|
         am.external_system
      end
      row ("Error") do |em|
         "Unable retrieve data from Apollo: #{apollo_error}"
      end
   end
else
   attributes_table_for external_metadata do
      row :title
      row("External System") do |am|
         am.external_system
      end
      row("Collection PID") do |xm|
         # Apollo is single page app and the history mode doesn't work right
         # because of the shibboleth proxy. All URLs are links to ID instead of real URL
         link_to apollo_info[:pid], "#{Settings.apollo_url}/#/collections/#{apollo_info[:pid]}", target: "_blank"
      end
      row("Collection Title") do |xm|
         apollo_info[:collection]
      end
      row("Collection Barcode") do |xm|
         apollo_info[:barcode]
      end
      row("Collection Catalog Key") do |xm|
         apollo_info[:catalog_key]
      end
      row("Use Rights") do |xm|
         link_to apollo_info[:rights], apollo_info[:rights_uri], target: "_blank"
      end
      row("Item PID") do |xm|
         apollo_info[:item_pid]
      end
      row("Item Type") do |xm|
         apollo_info[:item_type]
      end
      row("Item Title") do |xm|
         apollo_info[:item_title]
      end
   end
end
