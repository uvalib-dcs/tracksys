div :class => 'columns-none' do
   div :class => 'two-column' do
      panel "Item Information" do
         attributes_table_for project do
            row("Call Number") do |project|
               project.unit.metadata.call_number
            end
            row :viu_number, class: "viu_row" do |project|
               div do
                  v = project.viu_number
                  v = "<span class='empty'>Empty</span>" if v.blank?
                  disp = "<span class='disp-item' id='viu_number'>#{v}</span>"
                  raw("#{disp}<input type='text' class='hidden edit-item' id='viu_number-edit' value='#{project.viu_number}'/>")
               end
               if current_user == project.owner
                  div class: "viu-button-bar" do
                     span class: "project mf-action-button item edit-btn" do "Edit" end
                     span class: "project mf-action-button hidden item save-btn"  do "Save" end
                     span class: "project mf-action-button hidden item cancel-btn" do "Cancel" end
                  end
               end
            end
            row("Location") do |project|
               project.unit.metadata.location
            end
            row("Title") do |project|
               project.unit.metadata.title
            end
            row ("Special Instructions") do |project|
               si = []
               si << "#{project.order.special_instructions}" if !project.order.special_instructions.blank?
               si << "#{project.unit.special_instructions}" if !project.unit.special_instructions.blank?
               si << "None" if si.length == 0
               raw("#{si.join('<br/>')}")
            end
            row :item_condition do |project|
               project.item_condition
            end
            row ("Condition Notes") do |project|
               project.condition_note
            end
         end
      end
   end
   div :class => 'two-column' do
      panel "Equipment" do
         attributes_table_for project do
            row :workstation do |project|
               v = "<span class='empty'>Empty</span>"
               data_id = ""

               if !project.workstation.blank?
                  v = project.workstation.name
                  data_id = "data-id='#{project.workstation.id}'"
               end
               disp = "<span #{data_id}' class='disp-camera' id='workstation'>#{v}</span>"
               sel = "<select id='workstation-edit' class='hidden edit-camera'>"
               sel << "<option value=''>Choose a workstation</option>"
               Workstation.available.each do |w|
                  if project.workstation == w
                     sel << "<option value='#{w.id}' selected>#{w.name}</option>"
                  else
                     sel << "<option value='#{w.id}'>#{w.name}</option>"
                  end
               end
               sel << "</select>"
               raw("#{disp}#{sel}")
            end
            row ("setup") do |project|
               render partial: "project_equipment", locals: {equipment: project.equipment}
            end
            row :capture_resolution do |project|
               v = project.capture_resolution
               v = "<span class='empty'>Empty</span>" if v.blank?
               disp = "<span class='disp-camera' id='capture_resolution'>#{v}</span>"
               raw("#{disp}<input type='text' class='hidden edit-camera' id='capture_resolution-edit' value='#{project.capture_resolution}'/>")
            end
            row :resized_resolution do |project|
               v = project.resized_resolution
               v = "<span class='empty'>Empty</span>" if v.blank?
               disp = "<span class='disp-camera' id='resized_resolution'>#{v}</span>"
               raw("#{disp}<input type='text' class='hidden edit-camera' id='resized_resolution-edit' value='#{project.resized_resolution}'/>")
            end
            row :resolution_note do |project|
               v = project.resolution_note
               v = "<span class='empty'>Empty</span>" if v.blank?
               disp = "<span class='disp-camera' id='resolution_note'>#{v}</span>"
               raw("#{disp}<textarea class='hidden edit-camera' id='resolution_note-edit'>#{project.resolution_note}</textarea>")
            end
         end
         if current_user == project.owner
            div class: "mini-button-bar" do
               span class: "project mf-action-button camera edit-btn" do "Edit" end
               span class: "project mf-action-button hidden camera save-btn"  do "Save" end
               span class: "project mf-action-button hidden camera cancel-btn" do "Cancel" end
            end
         end
      end
   end
end

div :class => 'columns-none' do
   div :class => 'two-column' do
      panel "Order Information" do
         attributes_table_for project do
            row :project_name
            row :customer
            row ("Customer Status") do |project|
               project.customer.academic_status.name
            end
            row :due_on do |project|
              format_date(project.due_on)
            end
         end
      end
   end

   div :class => 'two-column' do
      panel "Deliverables" do
         attributes_table_for project do
            row ("Intended Use") do |project|
               project.unit.intended_use.name
            end
            row ("Resolution") do |project|
               project.unit.intended_use.deliverable_resolution
            end
            row ("Format") do |project|
               project.unit.intended_use.deliverable_format
            end
         end
      end
   end
end

div :class => 'columns-none' do
   div :class => 'two-column' do
      render partial: "history", locals: {project: project}
   end
   div :class => 'two-column' do
      render partial: "notes", locals: {project: project}
   end
end

render partial: "assign_staff", locals: {project: project}
