if !current_user.viewer? && !current_user.student?
   if unit.has_in_process_files?
      if unit.date_archived.blank? && unit.reorder == false
         div :class => 'workflow_button' do
            button_to "QA Unit Data", qa_unit_data_admin_unit_path , :method => :put
         end
         div :class => 'workflow_button' do
            button_to "QA Filesystem and XML", qa_filesystem_and_iview_xml_admin_unit_path , :method => :put
         end
         div :class => 'workflow_button' do
            button_to "Create Master File Records", import_unit_iview_xml_admin_unit_path, :method => :put
         end

         # Digital collection buliding?
         deliverables_ready = false
         if unit.intended_use.id == 110
            if unit.date_dl_deliverables_ready.blank?
               div :class => 'workflow_button' do
                  button_to "Generate Deliverables", check_unit_delivery_mode_admin_unit_path, :method => :put
               end
            else
               deliverables_ready = true
            end
         else
            # patron order
            if unit.date_patron_deliverables_ready.blank?
               div :class => 'workflow_button' do
                  button_to "Generate Deliverables", check_unit_delivery_mode_admin_unit_path, :method => :put
               end
            else
               deliverables_ready = true
               div :class => 'workflow_button' do
                  button_to "Regenerate Deliverables", regenerate_deliverables_admin_unit_path, :method => :put
               end
            end
         end

         div :class => 'workflow_button' do
            clazz = "disabled"
            clazz="" if deliverables_ready && unit.date_archived.blank?
            button_to "Send Unit to Archive", send_unit_to_archive_admin_unit_path,class: clazz, :method => :put
         end
      end
   else
      # NO in-process files....
      if unit.date_patron_deliverables_ready && unit.intended_use.id != 110
         if unit.date_patron_deliverables_ready
            div :class => 'workflow_button' do
               button_to "Regenerate Deliverables", regenerate_deliverables_admin_unit_path, :method => :put
            end
         end
      else
         if unit.date_archived.nil?
            div :class => 'workflow_button' do
               button_to "Manual Upload to Archive",
               start_manual_upload_to_archive_admin_unit_path, :method => :get
            end
            div :class => 'workflow_button' do
               button_to "Finalize Raw Images",
               finalize_raw_images_admin_unit_path, :method => :get
            end
         end
      end
   end
end

if unit.date_archived
   div :class => 'workflow_button' do
      button_to "Download Unit From Archive", copy_from_archive_admin_unit_path(unit.id), :method => :put
   end
   div :class => 'workflow_button' do
      raw("<a class='admin-button' href='/admin/units/#{unit.id}/download_unit_xml' target='_blank'>Download Unit XML From Archive</a>")
   end
else
   if  unit.reorder == false
      div do
         "This unit cannot be downloaded because it is not archived."
      end
   end
end
