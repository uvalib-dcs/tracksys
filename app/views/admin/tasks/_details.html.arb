div :class => 'columns-none' do
   div :class => 'two-column' do
      panel "Item Information" do
         attributes_table_for task do
            row("Call Number") do |task|
               task.unit.metadata.call_number
            end
            row("Catalog Key") do |task|
               task.unit.metadata.catalog_key
            end
            row("Location") do |task|
               task.unit.metadata.location
            end
            row("Title") do |task|
               task.unit.metadata.title
            end
            row :item_condition do |task|
               sel = "<select id='condition-edit' class='hidden edit-condition'>"
               Task.item_conditions.to_a.each do |c|
                  sel << "<option value='#{c[1]}'>#{c[0]}</option>"
               end
               raw("<span class='disp-condition' id='condition'>#{task.item_condition}</span>#{sel}")
            end
         end
         if current_user == task.owner
            div class: "mini-button-bar" do
               span class: "task mf-action-button condition edit-btn" do "Edit" end
               span class: "task mf-action-button hidden condition save-btn"  do "Save" end
               span class: "task mf-action-button hidden condition cancel-btn" do "Cancel" end
            end
         end
      end
   end
   div :class => 'two-column' do
      panel "Special Instructions" do
         si = ""
         si << "<p>#{task.order.special_instructions}</p>" if task.order.special_instructions.blank?
         si << "<p>#{task.unit.special_instructions}</p>" if task.order.special_instructions.blank?
         si = "None" if si.length == 0
         raw("#{si}")
      end
   end
end

div :class => 'columns-none' do
   div :class => 'three-column' do
      panel "Order Information" do
         attributes_table_for task do
            row :project_name
            row :customer
            row ("Customer Status") do |task|
               task.customer.academic_status.name
            end
            row :due_on do |task|
              format_date(task.due_on)
            end
         end
      end
   end

   div :class => 'three-column' do
      panel "Deliverables" do
         attributes_table_for task do
            row ("Intended Use") do |task|
               task.unit.intended_use.name
            end
            row ("Resolution") do |task|
               task.unit.intended_use.deliverable_resolution
            end
            row ("Format") do |task|
               task.unit.intended_use.deliverable_format
            end
         end
      end
   end
   div :class => 'three-column' do
      panel "Equipment" do
         attributes_table_for task do
            row ("Camera") do |task|
               raw("<span class='disp-camera' id='camera'>#{task.camera}</span><input type='text' class='hidden edit-camera' id='camera-edit' value='#{task.camera}'/>")
            end
            row ("Lens") do |task|
               raw("<span class='disp-camera' id='lens'>#{task.lens}</span><input type='text' class='hidden edit-camera' id='lens-edit' value='#{task.lens}'/>")
            end
            row ("Resolution") do |task|
               raw("<span class='disp-camera' id='resolution'>#{task.resolution}</span><input type='text' class='hidden edit-camera' id='resolution-edit' value='#{task.resolution}'/>")
            end
         end
         if current_user == task.owner
            div class: "mini-button-bar" do
               span class: "task mf-action-button camera edit-btn" do "Edit" end
               span class: "task mf-action-button hidden camera save-btn"  do "Save" end
               span class: "task mf-action-button hidden camera cancel-btn" do "Cancel" end
            end
         end
      end
   end
end

div :class => 'columns-none' do
   div :class => 'two-column' do
      render partial: "history", locals: {task: task}
   end
   div :class => 'two-column' do
      panel "Notes" do
      end
   end
end
